<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:models="clr-namespace:MobileITJ.Models"
             xmlns:viewmodel="clr-namespace:MobileITJ.ViewModels"
             x:DataType="viewmodel:ViewRatingsViewModel"
             x:Class="MobileITJ.Views.Worker.ViewRatingsPage"
             Title="My Ratings"
             BackgroundColor="{StaticResource BackgroundColor}">

    <RefreshView Command="{Binding LoadRatingsCommand}" IsRefreshing="{Binding IsBusy}">

        <CollectionView ItemsSource="{Binding Ratings}"
                        EmptyView="No ratings received yet.">

            <CollectionView.Header>
                <Label Text="Client Feedback"
                       FontSize="22"
                       FontAttributes="Bold"
                       HorizontalOptions="Center"
                       Padding="20"
                       TextColor="{StaticResource TextDark}" />
            </CollectionView.Header>

            <CollectionView.ItemTemplate>
                <DataTemplate x:DataType="models:RatingDetail">
                    <Frame Padding="15" Margin="15,8" CornerRadius="10" BorderColor="#E0E0E0" HasShadow="True" BackgroundColor="White">
                        <VerticalStackLayout Spacing="8">

                            <Grid ColumnDefinitions="*, Auto">
                                <VerticalStackLayout Grid.Column="0">
                                    <Label Text="{Binding CustomerName}" 
                                           FontAttributes="Bold" 
                                           FontSize="16" 
                                           TextColor="{StaticResource PrimaryColor}"/>

                                    <Label Text="{Binding JobDescription}" 
                                           FontSize="12" 
                                           TextColor="Gray"
                                           FontAttributes="Italic"/>
                                </VerticalStackLayout>

                                <Label Grid.Column="1" 
                                       Text="{Binding Rating, StringFormat='â­ {0}'}" 
                                       FontSize="16" 
                                       TextColor="#FFB300" 
                                       FontAttributes="Bold" 
                                       VerticalOptions="Start"/>
                            </Grid>

                            <BoxView HeightRequest="1" Color="#F0F0F0" />

                            <Label Text="{Binding Review}" 
                                   FontSize="14" 
                                   TextColor="#333333" />

                        </VerticalStackLayout>
                    </Frame>
                </DataTemplate>
            </CollectionView.ItemTemplate>

        </CollectionView>
    </RefreshView>
</ContentPage>